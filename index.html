<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="GRAPE">
  <meta name="keywords"
    content="GRAPE: Generalizing Robot Policy via Preference Alignment">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GRAPE</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <link rel="icon" href="./favicon.ico">

  <meta property="og:site_name" content="GRAPE" />
  <meta property="og:type" content="video.other" />
  <meta property="og:title" content="GRAPE: Generalizing Robot Policy via Preference Alignment" />
  <meta property="og:description" content="by Zijian Zhang, Kaiyuan Zheng, Zhaorun Chen, Joel Jang, Yi Li, Chaoqi Wang, Mingyu Ding, Dieter Fox, Huaxiu Yao" />
  <meta property="og:url" content="https://grape-vla.github.io/" />
  <meta property="og:image" content="" />
  <meta property="og:image:secure" content="" />
  <meta property="og:video" content="https://github.com/GRAPE-VLA/GRAPE-VLA.github.io/blob/main/static/videos/grape.mov" />
  <meta property="og:video:secure" content="https://github.com/GRAPE-VLA/GRAPE-VLA.github.io/blob/main/static/videos/grape.mov" />
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="720" />

  <meta property="article:publisher" content="https://zzj1111.github.io/" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="GRAPE: Generalizing Robot Policy via Preference Alignment" />
  <meta name="twitter:description" content="by Zijian Zhang, Kaiyuan Zheng, Zhaorun Chen, Joel Jang, Yi Li, Chaoqi Wang, Mingyu Ding, Dieter Fox, Huaxiu Yao" />
  <meta name="twitter:url" content="https://grape-vla.github.io/" />
  <meta name="twitter:image" content="" />
  <meta name="twitter:site" content="" />
  <meta name="twitter:card" content="player" />
  <meta name="twitter:player" content="https://github.com/GRAPE-VLA/GRAPE-VLA.github.io/blob/main/static/videos/grape.mov" />
  <meta name="twitter:player:width" content="1280" />
  <meta name="twitter:player:height" content="720" />

  <script src="https://www.youtube.com/iframe_api"></script>
</head>


<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">GRAPE: Generalizing Robot Policy via Preference Alignment</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://zzj1111.github.io/">Zijian Zhang</a>*&nbsp;&nbsp;
                <a href="https://linkedin.com/in/kaiyuan-zheng-94984a236">Kaiyuan Zheng</a>*&nbsp;&nbsp;
                <a href="https://billchan226.github.io/">Zhaorun Chen</a>&nbsp;&nbsp;
                <a href="https://joeljang.github.io/">Joel Jang</a>&nbsp;&nbsp;
                <a href="https://yili.vision/">Yi Li</a>&nbsp;&nbsp;
                <a href="https://alecwangcq.github.io/">Chaoqi Wang</a>&nbsp;&nbsp;
                <a href="https://dingmyu.github.io/">Mingyu Ding</a>&nbsp;&nbsp;
                <a href="https://homes.cs.washington.edu/~fox/">Dieter Fox</a>&nbsp;&nbsp;
                <a href="http://huaxiuyao.mystrikingly.com/">Huaxiu Yao</a>&nbsp;&nbsp;

              </span>
            </div>
            <div class="column">
              <image src="./static/images/logo.jpg" style="width: 60%;"></image>
            </div>
            <!-- <div class="is-size-4 publication-authors">
              Preprint
            </div> -->
            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="./resources/2411.19309v1.pdf" class="external-link button is-normal is-rounded is-dark"
                    target="_blank">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <!-- Code Link. -->
                <span class="link-block">
                  <a href="https://github.com/aiming-lab/grape"
                    class="external-link button is-normal is-rounded is-dark" target="_blank">
                    <span class="icon">
                      <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false"
                        data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 496 512" data-fa-i2svg="">
                        <path fill="currentColor"
                          d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z">
                        </path>
                      </svg><!-- <i class="fab fa-github"></i> Font Awesome fontawesome.com -->
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <span class="link-block"></span>
                  <a href="https://huggingface.co/ZijianZhang/OpenVLA-7B-GRAPE-Simpler"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <svg width="800px" height="800px" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet"><ellipse fill="#F4900C" cx="33.5" cy="14.5" rx="2.5" ry="3.5"></ellipse><ellipse fill="#F4900C" cx="2.5" cy="14.5" rx="2.5" ry="3.5"></ellipse><path fill="#FFAC33" d="M34 19a1 1 0 0 1-1 1h-3a1 1 0 0 1-1-1v-9a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v9zM7 19a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-9a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v9z"></path><path fill="#FFCC4D" d="M28 5c0 2.761-4.478 4-10 4C12.477 9 8 7.761 8 5s4.477-5 10-5c5.522 0 10 2.239 10 5z"></path><path fill="#F4900C" d="M25 4.083C25 5.694 21.865 7 18 7c-3.866 0-7-1.306-7-2.917c0-1.611 3.134-2.917 7-2.917c3.865 0 7 1.306 7 2.917z"></path><path fill="#269" d="M30 5.5C30 6.881 28.881 7 27.5 7h-19C7.119 7 6 6.881 6 5.5S7.119 3 8.5 3h19A2.5 2.5 0 0 1 30 5.5z"></path><path fill="#55ACEE" d="M30 6H6a2 2 0 0 0-2 2v26h28V8a2 2 0 0 0-2-2z"></path><path fill="#3B88C3" d="M35 33v-1a2 2 0 0 0-2-2H22.071l-3.364 3.364a.999.999 0 0 1-1.414 0L13.929 30H3a2 2 0 0 0-2 2v1c0 1.104-.104 2 1 2h32c1.104 0 1-.896 1-2z"></path><circle fill="#FFF" cx="24.5" cy="14.5" r="4.5"></circle><circle fill="#DD2E44" cx="24.5" cy="14.5" r="2.721"></circle><circle fill="#FFF" cx="11.5" cy="14.5" r="4.5"></circle><path fill="#F5F8FA" d="M29 25.5a2.5 2.5 0 0 1-2.5 2.5h-17a2.5 2.5 0 1 1 0-5h17a2.5 2.5 0 0 1 2.5 2.5z"></path><path fill="#CCD6DD" d="M17 23h2v5h-2zm-5 0h2v5h-2zm10 0h2v5h-2zM7 25.5a2.5 2.5 0 0 0 2 2.45v-4.9a2.5 2.5 0 0 0-2 2.45zm20-2.45v4.899a2.5 2.5 0 0 0 0-4.899z"></path><circle fill="#DD2E44" cx="11.5" cy="14.5" r="2.721"></circle></svg>
                    </span>
                    <span>Model</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="hero teaser teaser-video">
    <div class="container is-max-desktop has-text-centered">
      <div class="hero-body">
        <video id="teaser" autoplay="" muted="" loop="" playsinline="" width="85%">
          <source src="static/videos/grape.mov" type="video/mp4">
        </video>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">GRAPE Method</h2>
          <div class="content has-text-justified has-text-centered">
            <img src="static/images/grape_model.png">
            <p>
              <strong>Overview of GRAPE</strong>. Given a complex manipulation task (<strong>top</strong>), GRAPE first
              adopts a vision-language model to decompose the task into several temporal stages, then identifies spatial keypoints essential for each stage’s subtask completion. Then given user-specified alignment goals, GRAPE prompts a powerful vision-language model to obtain a series of cost functions for each stage, where lower cost implies higher alignment compliance. During iterative preference optimization (<strong>bottom</strong>), we sample multiple offline trajectories from the base VLA model and obtain trajectories with associated multi-stage costs. This score further incorporates the model’s self-evaluation of
              each trajectory and a binary task success indicator. Then we rank the sampled trajectories with their
              corresponding scores to obtain a list of preferences. Then we perform a trajectory-wise preference optimization to obtain a improved model, from which we further sample online trajectories and iterate until convergence.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Experiments</h2>

          <h3 class="title is-4">Simulation Experiments</h3>
          <div class="has-text-centered">
            <img src="static/images/grape_simulation_experiments_simpler_env.png" alt="Simpler Env Experiments" style="width: 75%;">
          </div>
          <div class="content has-text-justified">

            <p>
              Comparison of GRAPE with OpenVLA and Octo finetuned on the same data on the Simpler-Env environment. We report the in-domain performance, which includes four tasks and three generalization evaluations (subject, physical, and semantic), where each incorporates multiple tasks.
            </p>
          </div>

          <br>

          <div class="has-text-centered">
            <img src="static/images/grape_simulation_experiments_libero.png" alt="LIBERO Experiments" style="width: 70%;">
          </div>
          <div class="content has-text-justified">

            <p>
              Comparison of GRAPE with OpenVLA and Octo finetuned on the same data on the LIBERO environment. We report
              the performance on four LIBERO tasks, including LIBERO-Spatial, LIBERO-Object, LIBERO-Goal, LIBERO-Long.
            </p>
          </div>

          <br>

          <h3 class="title is-4">Real-world Experiments</h3>
          <img src="static/images/grape_real_world_experiments.png">
          <div class="content has-text-justified">

            <p>
              Comparison of GRAPE with OpenVLA and Octo fine-tuned on the same data on the real-world environment. We
              report the in-domain performance, which includes four tasks and five generalization evaluations (visual, subject,
              action, semantic, and language grounding), where each incorporates multiple tasks. We also report the average performance across all tasks.
            </p>
          </div>

          <br>
          <h3 class="title is-4">Rollouts of GRAPE</h3>

          <br>
          <h4 class="title is-6">Real-World Tasks</h4>
          <div class="columns is-vcentered interpolation-panel">
            <div class="column  has-text-centered">
              <h5>In-domain tasks</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/domain_success.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Language Grounding</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/language_success.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Semantic Gen: New instructions</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/semantics_success.mp4" type="video/mp4">
              </video>
            </div>
          </div>

          <div class="columns is-vcentered interpolation-panel">
            <div class="column  has-text-centered">
              <h5>Action Gen: New actions (<i>knock down</i>)</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/action_knock_success.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Visual Gen: Different background</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/visual_success.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Subject Gen: New objects</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/climb/subject_success.mp4" type="video/mp4">
              </video>
            </div>
          </div>

          <br>
          <h4 class="title is-6">Simpler-Env</h4>
          <div class="columns is-vcentered interpolation-panel">
            <div class="column  has-text-centered">
              <h5>In-domain tasks</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/leap/in-domain.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Subject Gen: New objects</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/leap/subject.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5 style="font-size: 14px;">Semantic Gen: New instructions</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/leap/semantics.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5 style="font-size: 12px;">Physical Gen: Different sizes/shapes</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/leap/physical.mp4" type="video/mp4">
              </video>
            </div>
          </div>

          <br>
          <h4 class="title is-6">LIBERO</h4>
          <div class="columns is-vcentered interpolation-panel">
            <div class="column  has-text-centered">
              <h5>LIBERO-10</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/crawl/libero-10.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>LIBERO-GOAL</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/crawl/libero-goal.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>LIBERO-Object</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/crawl/libero-object.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>LIBERO-Spatial</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/crawl/libero-spatial.mp4" type="video/mp4">
              </video>
            </div>
          </div>

          <br>
          <h4 class="title is-6">Learned Safety Behaviors</h4>
          <div class="content has-text-justified">
            <p>We selected safe trajectories based on GCPG reward, then we TPO-trained the OpenVLA-SFT to get
              GRAPE-Safety. The robot learns to complete the task safely.</p>
          </div>
          <div class="columns is-vcentered interpolation-panel">
            <div class="column  has-text-centered">
              <h5>Unsafe behavior demonstrated by the GRAPE</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/retry/unsafety_success.mp4" type="video/mp4">
              </video>
            </div>
            <div class="column  has-text-centered">
              <h5>Safe behavior demonstrated by the GRAPE-Safety</h5>
              <video autoplay="" controls="" muted="" loop="" playsinline="" width="100%">
                <source src="./resources/retry/safety_success.mp4" type="video/mp4">
              </video>
            </div>
          </div>


          <!--BibTex citation -->
          <section class="section" id="BibTeX">
            <div class="container is-max-desktop content">
              <h2 class="title">BibTeX</h2>
              <pre><code>@misc{zhang2024grape,
                title={GRAPE: Generalizing Robot Policy via Preference Alignment}, 
                author={Zijian Zhang and Kaiyuan Zheng and Zhaorun Chen and Joel Jang and Yi Li and Chaoqi Wang and Mingyu Ding and Dieter Fox and Huaxiu Yao},
                year={2024},
                eprint={2411.19309},
                archivePrefix={arXiv},
                primaryClass={cs.RO},
                url={https://arxiv.org/abs/2411.19309}, 
      }</code></pre>
            </div>
          </section>
          <!--End BibTex citation -->


          <table width="100%" align="center" border="0" cellspacing="0" cellpadding="20">
            <tbody>
                <tr>
                  <td style="padding:0px; padding-bottom: 30px;"> <!-- Add padding-bottom here -->
                        <br>
                        <br>
                        <div>
                          <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=ffffff&w=300&t=tt&d=ramCv772Q0lyfA1IJAYxhDOW1uQ92sGQnXzZkOYKF1Y'></script>
                        </div>
                    </td>
                </tr>
            </tbody>
          </table>

          


          <footer class="footer">
            <div class="container">
              <div class="content has-text-centered">
                <p>Page template borrowed from <a href="https://nerfies.github.io/"><span
                      class="dnerf">Nerfies</span></a> and
                  <a href="https://robot-parkour.github.io/"><span class="dnerf">robot-parkour</span></a>.
                </p>
              </div>
            </div>
          </footer>

</body>

</html>
